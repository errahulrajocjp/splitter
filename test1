@Test
void testCheck5GCoverageForAddresses_InvalidSplitAddressResponse() {
    // Setup
    FiveGCoverageCheckRequest request = new FiveGCoverageCheckRequest();
    List<CustomerAddress> addresses = new ArrayList<>();
    CustomerAddress address = new CustomerAddress();
    address.setAddressLine1("123 Main St");
    address.setZipCode("10001");
    addresses.add(address);
    request.setCustomerAddress(addresses);

    // Create invalid split response (address = null)
    SplitAddressResponse invalidResponse = new SplitAddressResponse();
    SplitAddressResponse.SplitAddressResponseData data = new SplitAddressResponse.SplitAddressResponseData();
    AddressSplit addressSplit = new AddressSplit();
    AddressSplit.AddressSplitServiceResponse splitResponse = new AddressSplit.AddressSplitServiceResponse();
    splitResponse.setAddress(null);  // Invalid - address is null
    addressSplit.setResponse(splitResponse);
    data.setAddressSplit(addressSplit);
    invalidResponse.setData(data);

    when(spectrumAdapterService.splitAddress(any())).thenReturn(Mono.just(invalidResponse));

    // Execute - When ALL addresses fail, we get an ERROR response (FAILURE_STATUS)
    StepVerifier.create(validateBusinessAccountHelper.check5GCoverageForAddresses(request))
            .assertNext(response -> {
                assertNotNull(response);
                assertNotNull(response.getData());
                // When all addresses fail, statusCode is FAILURE_STATUS
                assertEquals(SmbConstants.FAILURE_STATUS, response.getData().getStatusCode());
                // Errors should be populated
                assertNotNull(response.getData().getErrors());
                assertFalse(response.getData().getErrors().isEmpty());
                // Response object is null when error occurs
                assertNull(response.getData().getResponse());
            })
            .verifyComplete();
}
